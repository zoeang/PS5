library(devtools)
library(roxygen2)
setwd("C:\Users\zoeja\OneDrive\Documents\Spring2018\R\PS5") #This will need to be changed to match your directory
getwd()
current.code <- as.package("integrateIt")
create(integrateIt)
document()
x<-c(.6,1,1.7,1.7,2.2,2.2,2.8,3.5,3.5,4.2)
xbar<-mean(x)
xbar
y<-c8,3,5,11,10,19,9,14,22,22)
ybar<-mean(y)
x-xbar
xprime<-x-xbar
yprime<-y-ybar
crossprod(xprime, yprime)
yprime<-y-ybar
y<-c8,3,5,11,10,19,9,14,22,22)
ybar<-mean(y)
xprime<-x-xbar
yprime<-y-ybar
crossprod(xprime, yprime)
y<-c(8,3,5,11,10,19,9,14,22,22)
ybar<-mean(y)
xprime<-x-xbar
yprime<-y-ybar
crossprod(xprime, yprime)
54.58/66.8
sum(xprime^2)
xprime^2
crossprod(xprime, xprime)
54.58/12.044
crossprod(yprime)
412.1/8
51.2125/12.044
x<-matrix(c(rep(1,10),.6,1,1.7,1.7,2.2,2.2,2.8,3.5,3.5,4.2), nrow=10)
x
y<-matrix(c(8,3,5,11,10,19,9,14,22,22), nrow=10)
y
t(x)%*%x
xtx<-t(x)%*%x
t(x)%*%y
xty<-t(x)%*%y
beta<-solve(xtx)%*%xty
beta
t(y)%*%y
as.vector(beta[2,1])*xtx
2*beta%*%xtx
2*t(beta)%*%xtx
t(beta)%*%xtx%*%beta
2*t(beta)%*%xtx
xtx
beta
t(beta)%*%xtx
2*t(beta)%*%xtx
mid<-2*t(beta)%*%xtx
mid[1.1]*mid[1,2]
20.59*solve(xtx)
library(faraway)
prostatelmg<-lm(lpsa~lcavol+lweight+svi+lbph+age+lcp+pgg45+gleason, data=prostate)
var.test(prostate.lmg)
var.test(prostatelmg)
var.test(x=lcavol+lweight+svi+lbph+age+lcp+pgg45+gleason, y=lpsa)
var.test(lpsa~lcavol+lweight+svi+lbph+age+lcp+pgg45+gleason, data=prostate)
summary(prostatelmg)
prostatesub<-lm(lpsa~lcp+pgg45+gleason, prostate)
anova(prostatesub, prostate)
prostatesub<-lm(lpsa~lcavol+lweight+svi+lbph+age+I(lcp+pgg45+gleason), data=prostate)
anova(prostatesub, prostate)
library(stargazer)
stargazer(anova(prostatesub, prostate))
anova(prostatesub, prostate)
stargazer(anova(prostatesub, prostate))
confidence.ellipse(prostatelmg, which.coef=c(lcp, pgg45))
library(car)
confidence.ellipse(prostatelmg, which.coef=c(lcp, pgg45))
help("Deprecated")
library(faraway)
install.packages("ellipse")
summary(prostatelmg)
prostatelmg[7]
require(ellipse)
plot(ellipse(prostatelmg, c(7,8), type="l"))
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
require(ellipse)
plot(0, type="n")
ellipse(prostatelmg, c(7,8), type="l")
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
plot(ellipse(prostatelmg, c(7,8), type="l"))
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
require(ellipse)
plot(ellipse(prostatelmg, c(7,8), type="p"),main="95 percent Joint CI for lcp and pgg45" )
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
plot(ellipse(prostatelmg, c(7,8), type="1"),main="95 percent Joint CI for lcp and pgg45" )
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
require(ellipse)
plot(ellipse(prostatelmg, c(7,8), type="l"),main="95 percent Joint CI for lcp and pgg45" )
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
plot(ellipse(prostatelmg, c(7,8)),main="95 percent Joint CI for lcp and pgg45" )
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
plot(ellipse(prostatelmg, c(7,8), lty=1),main="95 percent Joint CI for lcp and pgg45" )
require(car)
plot(ellipse(prostatelmg, c(7,8), lty=1),main="95 percent Joint CI for lcp and pgg45" )
dev.off()
plot(ellipse(prostatelmg, c(7,8), lty=1),main="95 percent Joint CI for lcp and pgg45" )
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
plot(ellipse(prostatelmg, c(7,8), type=l),main="95 percent Joint CI for lcp and pgg45" )
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
dev.off()
plot(ellipse(prostatelmg, c(7,8)), lty="l",main="95 percent Joint CI for lcp and pgg45" )
dev.off()
plot(ellipse(prostatelmg, c(7,8)), lty=2,main="95 percent Joint CI for lcp and pgg45" )
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
abline(v=confint(prostatelmg)[7,], lty=2)
abline(h=confint(prostatelmg)[7,], lty=2)
confint(prostatelmg)[7,]
confint(prostatelmg)[8,]
abline(v=confint(prostatelmg)[8,], lty=2)
dev.off()
plot(ellipse(prostatelmg, c(7,8), type="l"),main="95 percent Joint CI for lcp and pgg45",
xlim=c(-.3, .8))
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
abline(h=confint(prostatelmg)[7,], lty=2)
abline(v=confint(prostatelmg)[8,], lty=2)
dev.off()
plot(ellipse(prostatelmg, c(7,8), type="l"),main="95 percent Joint CI for lcp and pgg45",
xlim=c(-.3, .08))
dev.off()
plot(ellipse(prostatelmg, c(7,8), type="l"),main="95 percent Joint CI for lcp and pgg45",
xlim=c(-.5, .1))
dev.off()
plot(ellipse(prostatelmg, c(7,8), type="l"),main="95 percent Joint CI for lcp and pgg45")
abline(h=confint(prostatelmg)[7,], lty=2)
abline(h=confint(prostatelmg)[8,], lty=2)
confint(prostatelmg)[7,]
abline(v=confint(prostatelmg)[7,], lty=2)
dev.off()
plot(ellipse(prostatelmg, c(7,8)), type="l",main="95 percent Joint CI for lcp and pgg45")
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
abline(v=confint(prostatelmg)[7,], lty=2)
abline(h=confint(prostatelmg)[8,], lty=2)
abline(v=0, col="red")
abline(h=0, col="red")
points(0,0,col="red", pch=19)
dev.off()
plot(ellipse(prostatelmg, c(7,8)), type="l",main="95 percent Joint CI for lcp and pgg45")
points(coef(prostatelmg)[7], coef(prostatelmg)[8], pch=19)
abline(v=confint(prostatelmg)[7,], lty=2)
abline(h=confint(prostatelmg)[8,], lty=2)
points(0,0,col="red", pch=*)
points(0,0,col="red", pch=19)
sviprostate<-lm(lpsa~lcavol+I(lweight+.5*svi)+lbph+age+lcp+pgg45+gleason, data=prostate)
anova(sviprostate, prostatelmg)
stargazer(anova(sviprostate, prostatelmg))
data (USArrests)
plot (Assault~UrbanPop, data=USArrests, pch=19)
abline (lm (Assault~UrbanPop, data=USArrests), col="red")
S <- sample (1:nrow(USArrests), 41) # n=50, sample size=41
mod <- lm (Assault~UrbanPop, data=USArrests[S,])
Pred <- cbind (predict (mod, newdata=USArrests[-S,], interval="prediction"), USArrests$Assault[-S])
require (MASS)
se.YX <- sqrt (crossprod (resid (mod)) / (nrow(USArrests)-9-2))
par (mfrow=c(3,3), mar=c(3,3,0,0))
for (i in 1:(nrow(USArrests)-length(S))){
pred.Y <- mvrnorm (250, coef(mod), vcov (mod)) %*% c(1, USArrests$UrbanPop[c(1:50)[-S][i]]) + rnorm (250, 0, se.YX)
hist (pred.Y, xlim=c(-200, 600), main="")
abline (v=USArrests[-S,]$Assault[i], col="red")
}
par (mfrow=c(3,3), mar=c(3,3,0,0))
for (i in 1:(nrow(USArrests)-length(S))){
exp.Y <- mvrnorm (250, coef(mod), vcov (mod)) %*% c(1, USArrests$UrbanPop[c(1:50)[-S][i]])
hist (exp.Y, xlim=c(-200, 600), main="")
abline (v=USArrests[-S,]$Assault[i], col="red")
}
X <- runif (200, -5, 10)
Y1 <- 5 + 2*X + rnorm (200, 0, 10)
dataset1 <- data.frame (Y=Y1, X=X)
X <- runif (200, -5, 10)
Y1 <- 5 + 2*X + rnorm (200, 0, 10)
dataset1 <- data.frame (Y=Y1, X=X)
Y2 <- X - 0.5*X^2 + 0.1*X^3 + rnorm (200, 0, 10)
plot (Y1~X)
dev.off()
plot (Y1~X)
plot (Y2~X)
round (summary (lm (Y1 ~ X))$r.squared,2)
round (summary (lm (Y1 ~ X))$adj.r.squared,2)
round (summary (lm (Y1 ~ X + I(X^2)))$r.squared,2)
round (summary (lm (Y1 ~ X + I(X^2)))$adj.r.squared,2)
round (summary (lm (Y1 ~ X + I(X^2) + I(X^3)))$r.squared,2)
round (summary (lm (Y1 ~ X + I(X^2) + I(X^3)))$adj.r.squared,2)
round (summary (lm (Y2 ~ X))$r.squared,2)
round (summary (lm (Y2 ~ X))$adj.r.squared,2)
round (summary (lm (Y2 ~ X + I(X^2)))$r.squared,2)
round (summary (lm (Y2 ~ X + I(X^2)))$adj.r.squared,2)
round (summary (lm (Y2 ~ X + I(X^2) + I(X^3)))$r.squared,2)
round (summary (lm (Y2 ~ X + I(X^2) + I(X^3)))$adj.r.squared,2)
S  <-  sort (sample  (1:length(X), 100))  #  n=200,  sample size=100
mod1 <- lm  (Y~X, data=dataset1[S,])  # correct model
mod2 <- lm (Y ~ X + I(X^2) + I(X^3), data=dataset1[S,])  # wrong model
x<-c(rep(1,20), 3.58,18.23,12.1,15.13,8.32,19.9,5.9,17.6,1.68,12.57,
12.25,17.19,6.64,13.57,15.88,4.78,18.15,18.56,4.03,18.85, 39.07,
54.62,34.08,49.35,48.96,62.3,44,45.49,68.26,39.85, 41.73,36.21,59.94,45.07,41.55,30.65,
31.54,38.8,68,64,30.16, nrow=20)
print(x)
x<-matrix(c(rep(1,20), 3.58,18.23,12.1,15.13,8.32,19.9,5.9,17.6,1.68,12.57,
12.25,17.19,6.64,13.57,15.88,4.78,18.15,18.56,4.03,18.85, 39.07,
54.62,34.08,49.35,48.96,62.3,44,45.49,68.26,39.85, 41.73,36.21,59.94,45.07,41.55,30.65,
31.54,38.8,68,64,30.16), nrow=20)
x<-matrix(c(rep(1,20), 3.58,18.23,12.1,15.13,8.32,19.9,5.9,17.6,1.68,12.57,
12.25,17.19,6.64,13.57,15.88,4.78,18.15,18.56,4.03,18.85, 39.07,
54.62,34.08,49.35,48.96,62.3,44,45.49,68.26,39.85, 41.73,36.21,59.94,45.07,41.55,30.65,
31.54,38.8,68.64,30.16), nrow=20)
print(x)
View(x)
y<-matrix(c(39.32,198.64,175,47,40.36,17.66,78.49,48.04,157.67,11.29,39.51,23.23,
100.66,31.52,128.6,169.41,37.85,62.44,14.48,37.85,17.64), nrow=20)
y<-matrix(c(39.32,198.64,175.47,40.36,17.66,78.49,48.04,157.67,11.29,39.51,23.23,
100.66,31.52,128.6,169.41,37.85,62.44,14.48,37.85,17.64), nrow=20)
beta<-solve(t(x)%*%x)%*%t(x)%*%y
beta
rownames(beta)<-c("int", "Bk", "Bl")
beta
fullmod<-lm(y~x)
submat<-matrix(c(0,1,1), nrow=3)
submat
submat<-matrix(c(0,1,1), ncol=3)
submat%*%beta
resid(fullmod)
as.matrix(resid(fullmod))
e<-as.matrix(resid(fullmod))
t(e)%*%e*(1/20-2-1)
1/20-2-1
sehat<-t(e)%*%e*(1/17)
sehat
fullmod<-lm(y~x)
coefs(fullmod)
coef(fullmod)
beta
beta2<-coef(fullmod)
beta2
submat%*%beta
b0<-as.vector(submat%*%beta)
sehats<-t(e)%*%e*(1/17)
sehats
bo-1/sqrt(as.vector(sehats))
b0-1/sqrt(as.vector(sehats))
sqrt(as.vector(sehats))
b0-1
b0-1/sqrt(as.vector(sehats))
(b0-1)/sqrt(as.vector(sehats))
2*pt(t, 2)
t
tstat<-(b0-1)/sqrt(as.vector(sehats))
2*pt(tstat, 2)
tstat
2*pt(tstat, 17)
x[,2]
x[,3]
submod<-lm(y~offset(1*x[,2]+x[,3]))
submod
coef(submod)
anova(sobmod, fullmod)
anova(submod, fullmod)
submod2<-lm(y~offset(1*I(x[,2]+x[,3])))
anova(submod2, fullmod)
submod<-lm(y~offset(1*I(x[,2]+x[,3])))
anova(submod, fullmod)
tstat
2*pt(tstat, 17)
2*pt(tstat, 19)
2*dt(tstat, 17)
1-2*dt(tstat, 17)
2*pt(tstat, 19)
1-2*dt(tstat, 19)
pt(tstat, 19)
resid(submod)
es<-as.matrix(resid(submod))
subse<-t(e)%*%e/19
subse
sehats
tstat<-(b0-1)/sqrt(as.vector(subse))
pt(tstat, 19)
anova(submod, fullmod)
stargazer(anova(submod, fullmod))
anova(sviprostate, prostatelmg)
sviprostate<-lm(lpsa~lcavol+I(lweight+.5*svi)+lbph+age+lcp+pgg45+gleason, data=prostate)
anova(sviprostate, prostatelmg)
prostatelmg<-lm(lpsa~lcavol+lweight+svi+lbph+age+lcp+pgg45+gleason, data=prostate)
sviprostate<-lm(lpsa~lcavol+I(lweight+.5*svi)+lbph+age+lcp+pgg45+gleason, data=prostate)
anova(sviprostate, prostatelmg)
submat%*%beta
submat
beta
subse
es<-as.matrix(resid(submod))
subse<-t(es)%*%e/19
es<-as.matrix(resid(submod))
subse<-t(es)%*%es/19
subse
tstat<-(b0-1)/sqrt(as.vector(subse))
tstat
pt(tstat, 19)
subse<-t(es)%*%es/2
tstat<-(b0-1)/sqrt(as.vector(subse))
pt(tstat, 2)
lbc<-b0-1
lbc
submat%*%solve(t(x)%*%x)
lbc*submat%*%solve(t(x)%*%x)%*%t(submat)*lbc
subse
lbc*submat%*%solve(t(x)%*%x)%*%t(submat)*lbc/(2*as.vector(subse))
(lbc*submat%*%solve(t(x)%*%x)%*%t(submat)*lbc)/(2*as.vector(subse))
f<-(lbc*submat%*%solve(t(x)%*%x)%*%t(submat)*lbc)/(2*as.vector(subse))
pf(f, 2, 17)
sehats<-t(e)%*%e*(1/17)
e<-as.matrix(resid(fullmod))
sehats<-t(e)%*%e*(1/17)
f<-(lbc*solve(submat%*%solve(t(x)%*%x)%*%t(submat))*lbc)/(2*as.vector(sehats))
f
pf(f, 2, 17)
tstat<-(b0-1)/sqrt(as.vector(subse))
pt(tstat, 2)
solve(t(x)%*%x)%*%t(x)
beta
x%*%beta
y-x%*%beta
etest<-y-x%*%beta
t(etest)%*%etest
ee<-t(etest)%*%etest
ee/(17)
sehats<-t(e)%*%e*(1/17)
sehats
beta<-solve(t(x)%*%x)%*%t(x)%*%y #Beta matric
xx<-solve(t(x)%*%x)%*%t(x)# (X'X)^{-1}
L<-matrix(c(0,1,1), ncol=3) #Nested matrix
lb<-as.vector(L%*%beta) #L \beta
lbc<-lb-1 #Lb-c
e<-as.matrix(resid(fullmod)) #Squared error of full model
sehats<-t(e)%*%e*(1/17) #se^2; n-k-1=17
e1<-y-x%*%beta #The not-lazy way to calculate Squared error of the fill model
ee<-t(e1)%*%e1 #e'e
sehats1<-ee/(17)#e'e/n-k-1
f<-(lbc*solve(L%*%xx%*%t(L))*lbc)/(2*as.vector(sehats1)) #calculate F
L
xx
L%*%xx
t(L)
xx<-solve(t(x)%*%x)# (X'X)^{-1}
f<-(lbc*solve(L%*%xx%*%t(L))*lbc)/(2*as.vector(sehats1)) #calculate F
f
pf(f, 2, 17) #Probability of f when q=2 and n-k-1=17
